{"files":[{"id":"cf97a585-87cf-4ef8-b85f-130599611727","name":"studentResponse_to_teacherForm","type":"server_js","source":"function myFunction() \n{\n  \n  //fill out these three fields...\n  var Spreadsheet_ID \u003d \"1XPBfVnoLosTDL2FbeG83soE5HE5IQV6s10_4OjoSYGc\" \n  var A1_Notation \u003d \"C2:H32\"\n  var Counselor_Spreadsheet_ID \u003d \"1o58bGN0VLv6qF--PaSKdOQ1MW6N0vJl8LZj4YTtfOqs\"\n  \n  //******************************************* Parse the spreadsheet data *****************************\n  \n  var range \u003d SpreadsheetApp.openById(Spreadsheet_ID).getRange(A1_Notation);\n  var departments \u003d SpreadsheetApp.openById(Spreadsheet_ID).getRange(\"C1:G1\").getDisplayValues();\n  var periods_per_day \u003d SpreadsheetApp.openById(Counselor_Spreadsheet_ID).getRange(\"B2\").getDisplayValue();\n  \n  var studentData \u003d range.getDisplayValues();\n  var uniqueClasses \u003d Array(range.getNumColumns());\n  for (var c \u003d 0; c \u003c uniqueClasses.length; c++) {\n    uniqueClasses[c] \u003d Array(0);\n  }\n  \n  for (var c \u003d 0; c \u003c range.getNumColumns(); c++) {\n    for (var r \u003d 0; r \u003c range.getNumRows(); r++) {\n      if (uniqueClasses[c].indexOf(studentData[r][c]) \u003d\u003d -1) {\n        uniqueClasses[c].push(studentData[r][c]);\n      }\n    }\n    uniqueClasses[c].sort(); //sort by alphabetical order\n  }\n  \n  //********************************************* Make the new form ***********************************\n  \n  var form \u003d FormApp.create(\u0027Instructor Class Selection Form\u0027); //make new form\n \n  var checkBoxValidation \u003d FormApp.createCheckboxValidation()\n    .setHelpText(\u0027Select at least one class.\u0027)\n    .requireSelectAtLeast(1)\n    .build();\n  \n  //ask for name\n  form.addTextItem()\n    .setTitle(\u0027Name\u0027)\n    .setRequired(true);\n  \n  //ask for preferred prep period (make an array of choice values, then make the question)\n  var choices \u003d Array(0);\n  for (var i \u003d 1; i \u003c\u003d parseInt(periods_per_day); i++) {\n    choices.push(i.toString());\n  }\n  form.addMultipleChoiceItem()\n    .setTitle(\u0027Choose preferred prep period\u0027)\n    .setChoiceValues(choices)\n    .setRequired(true);\n  \n  //list out all of the classes by department and ask teacher to choose\n  //which classes they want to teach\n  form.addSectionHeaderItem()\n    .setTitle(\u0027Chooses classes you will teach\u0027)\n\n  for (var i \u003d 0; i \u003c departments[0].length; i++) {\n    form.addCheckboxItem()\n      .setTitle(departments[0][i])\n      .setChoiceValues(uniqueClasses[i])\n  }\n  \n  Logger.log(\u0027Published URL: \u0027 + form.getPublishedUrl());\n  Logger.log(\u0027Editor URL: \u0027 + form.getEditUrl());\n}\n"},{"id":"5c60ebbc-888d-4753-9e20-b21757ec3324","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}