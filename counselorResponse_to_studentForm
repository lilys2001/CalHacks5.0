{"files":[{"id":"2d62d0e4-e153-4081-b444-a29cefae3997","name":"counselorResponse_to_studentForm","type":"server_js","source":"function myFunction() \n{\n  //fill out these two fields...\n  var Spreadsheet_ID \u003d \"1o58bGN0VLv6qF--PaSKdOQ1MW6N0vJl8LZj4YTtfOqs\";\n  var A1_Notation \u003d \"A1:A11\";\n  \n  //************************************************ Parse the counselor spreadsheet into a usable format ******************\n  \n  var range \u003d SpreadsheetApp.openById(Spreadsheet_ID).getRange(A1_Notation);\n  var departments \u003d Array(0); //array of department names\n  var classes \u003d Array(0); //array of arrays (each element in nested array is string of name of class offered by a department)\n  \n  var disp_values \u003d Array(0);\n  for (r \u003d 0; r \u003c range.getNumRows(); r++) {\n    disp_values.push(range.getDisplayValues()[r][0]);\n  }\n  \n  count \u003d -1;\n  for (i \u003d 2; i \u003c disp_values.length; i++) {\n    if (i \u003d\u003d 2 || disp_values[i - 1] \u003d\u003d \"\") {\n      departments.push(disp_values[i]);\n      classes.push([]);\n      count++;\n    } else if (disp_values[i] \u003d\u003d \"\") {\n      continue;\n    } else {\n      classes[count].push(disp_values[i]);\n    }\n  }\n    \n  //*********************************************** Make the new student form ******************************************\n  \n  var form \u003d FormApp.create(\u0027Student Course Selection Form\u0027); //make new form\n  \n  form.addTextItem()\n    .setTitle(\u0027Student ID\u0027)\n    .setRequired(true);\n \n  for (i \u003d 0; i \u003c departments.length; i++) { //for each department\n    form.addMultipleChoiceItem() //make a new question asking the student to choose a course from that department\n      .setTitle(departments[i] + \" Course\")\n      .setChoiceValues(classes[i])\n      .setRequired(true);\n  }\n  \n  Logger.log(\u0027Published URL: \u0027 + form.getPublishedUrl());\n  Logger.log(\u0027Editor URL: \u0027 + form.getEditUrl());\n}\n"},{"id":"f8871791-7b6c-48af-955d-1ce93d4be0f0","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/Los_Angeles\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}